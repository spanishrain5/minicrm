<div class="card">
    <div class="card-header">
        Add new company
    </div>
    <div class="card-body">
        <form [formGroup] = "newCompanyForm" (ngSubmit)="submitForm()">

            <div class="mb-3">
                <label for="" class="form-label">*Name</label>
                <input type="text" name="" id="" 
                    class="form-control" 
                    formControlName="name"
                    [class.is-invalid]="!newCompanyForm.get('name')?.valid
                                         && newCompanyForm.get('name')?.touched">
                    <div class="helper-block" *ngIf="!newCompanyForm.get('name')?.valid
                                         && newCompanyForm.get('name')?.touched">
                                        Name must be only text between 2 and 30 symbols
                    </div>
            </div>
            
            <div class="mb-3">
                <label for="" class="form-label">Code</label>
                <input type="text" name="" id="" 
                    class="form-control" 
                    formControlName="code"
                    [class.is-invalid]="!newCompanyForm.get('code')?.valid
                                         && newCompanyForm.get('code')?.touched">
                    <div class="helper-block" *ngIf="!newCompanyForm.get('code')?.valid
                                         && newCompanyForm.get('code')?.touched">
                                        Company code must consist of numbers
                    </div>
            </div>

            <div class="mb-3">
                <label for="" class="form-label">PVM</label>
                <input type="text" name="" id="" 
                    class="form-control" 
                    formControlName="pvm"
                    [class.is-invalid]="!newCompanyForm.get('pvm')?.valid
                                         && newCompanyForm.get('pvm')?.touched">
                    <div class="helper-block" *ngIf="!newCompanyForm.get('pvm')?.valid
                                         && newCompanyForm.get('pvm')?.touched">
                                        PVM must consist of numbers or LT[numbers]
                    </div>
            </div>

            <div class="mb-3">
                <label for="" class="form-label">Address</label>
                <input type="text" name="" id="" 
                    class="form-control" 
                    formControlName="address"
                    [class.is-invalid]="!newCompanyForm.get('address')?.valid
                                         && newCompanyForm.get('address')?.touched">
            </div>

            <div class="mb-3">
                <label for="" class="form-label">*Email</label>
                <input type="text" name="" id="" 
                    class="form-control" 
                    formControlName="email"
                    [class.is-invalid]="!newCompanyForm.get('email')?.valid
                                         && newCompanyForm.get('email')?.touched">
                    <div class="helper-block" *ngIf="!newCompanyForm.get('email')?.valid
                                         && newCompanyForm.get('email')?.touched">
                                        Must be a valid email address
                    </div>
            </div>

            <div class="mb-3">
                <label for="" class="form-label">Phone</label>
                <input type="text" name="" id="" 
                    class="form-control" 
                    formControlName="phone"
                    placeholder="+370"
                    [class.is-invalid]="!newCompanyForm.get('phone')?.valid
                                         && newCompanyForm.get('phone')?.touched">
                    <div class="helper-block" *ngIf="!newCompanyForm.get('phone')?.valid
                                         && newCompanyForm.get('phone')?.touched">
                                        Must be a valid phone number (+370...)
                    </div>
            </div>

            <div class="mb-3">
                <label for="" class="form-label">Contacts</label>
                <div formArrayName="contacts">
                    <div *ngFor="let contact of contacts.controls; let i = index; trackBy: trackByIndex"
                    [formGroupName]="i" class="card px-3 py-2 mb-2">
                        <div class="mb-3">
                            <label for="" class="form-label">Name</label>
                            <input class="form-control"
                                formControlName="name"
                                > 
                        </div>
                        <div class="mb-3">
                            <label for="" class="form-label">Surname</label>
                            <input class="form-control"
                                formControlName="surname"
                                > 
                        </div>
                        <div class="mb-3">
                            <label for="" class="form-label">Role</label>
                            <input class="form-control"
                                formControlName="role"
                                > 
                        </div>
                        <div class="mb-3">
                            <label for="" class="form-label">Phone</label>
                            <input class="form-control"
                                formControlName="phone"
                                placeholder="+370"
                                [class.is-invalid]="!contact.get('phone')?.valid
                                         && contact.get('phone')?.touched">
                            <div class="helper-block" *ngIf="!contact.get('phone')?.valid
                                         && contact.get('phone')?.touched">
                                        Must be a valid phone number (+370...)
                            </div> 
                        </div>         
                    </div>
                    <div class="card px-3 py-2 mb-2 text-muted" *ngIf="contacts.controls.length == 0">
                        No contacts added
                    </div>
                </div>
                <div class="mt-3">
                    <button type="button" class="btn btn-success me-3" (click)="addContactField()">Add Contact</button>
                    <button type="button" class="btn btn-danger me-3" (click)="removeContactField()">Remove Contact</button>
                </div>
            </div>

            <div>
                <button type="submit" class="btn btn-success" [disabled]="!newCompanyForm.valid">Add</button>
            </div>
        </form>
    </div>
</div>
